# üßπ CleanUpDeb

–ö–æ–º–ø–∞–∫—Ç–Ω–∞—è bash-—É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ Debian/Ubuntu —Å–∏—Å—Ç–µ–º.

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/leonidSpiri/CleanUpDeb.git
cd CleanUpDeb
chmod +x cleanup.sh
```

–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É:
```bash
sudo cp cleanup.sh /usr/local/bin/cleanup
```

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥ —Å —É—Ç–∏–ª–∏—Ç–æ–π
cd CleanUpDeb

# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é
git pull origin main
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –†–µ–∂–∏–º –æ—Ç—á—ë—Ç–∞ (dry-run) ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞–Ω–æ
sudo ./cleanup.sh

# –†–µ–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ ‚Äî —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã
sudo ./cleanup.sh --apply

# –°–ø—Ä–∞–≤–∫–∞
./cleanup.sh --help
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ü–∏–∏

| –û–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-------|----------|--------------|
| `--apply` | –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –æ—á–∏—Å—Ç–∫—É | `false` (dry-run) |
| `--threshold –†–ê–ó–ú–ï–†` | –ü–æ—Ä–æ–≥ –∫—Ä—É–ø–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (50M, 1G) | `100M` |
| `--search-dir –ü–£–¢–¨` | –ö–∞—Ç–∞–ª–æ–≥ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ | `/` |
| `--journal-age –°–†–û–ö` | –í–æ–∑—Ä–∞—Å—Ç –∂—É—Ä–Ω–∞–ª–æ–≤ (3d, 2w) | `7d` |
| `-h, --help` | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É | ‚Äî |

### –ü—Ä–∏–º–µ—Ä—ã

```bash
# –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ > 500M –∏ –æ—á–∏—Å—Ç–∫–∞
sudo ./cleanup.sh --threshold 500M --apply

# –ü–æ–∏—Å–∫ –≤ /home, –∂—É—Ä–Ω–∞–ª—ã 3 –¥–Ω—è
sudo ./cleanup.sh --search-dir /home --journal-age 3d --apply
```

## üìã –≠—Ç–∞–ø—ã –æ—á–∏—Å—Ç–∫–∏

| ‚Ññ | –°–µ–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ê–≤—Ç–æ |
|---|--------|----------|------|
| 1 | –ö—Ä—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –∫–∞—Ç–∞–ª–æ–≥–∏ | –ê–Ω–∞–ª–∏–∑ du + —Ç–æ–ø-50 —Ñ–∞–π–ª–æ–≤; –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (TUI whiptail) | ‚ùå/‚úÖ* |
| 2 | APT-–∫–µ—à | `apt-get clean / autoclean` | ‚úÖ |
| 3 | –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã | `apt-get autoremove --purge` | ‚úÖ |
| 4 | –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã | –§–∞–π–ª—ã > 7 –¥–Ω–µ–π –≤ `/tmp`, `/var/tmp` | ‚úÖ |
| 5 | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–µ—à | `~/.cache` > 30 –¥–Ω–µ–π (—Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏) | ‚úÖ |
| 6 | –ñ—É—Ä–Ω–∞–ª—ã systemd | `journalctl --vacuum-time` | ‚úÖ |
| 7 | –ê—Ä—Ö–∏–≤–Ω—ã–µ –ª–æ–≥–∏ | `*.gz`, `*.old`, `*.1` –∏–∑ `/var/log` | ‚úÖ |
| 8 | –ú–∏–Ω–∏–∞—Ç—é—Ä—ã | `~/.cache/thumbnails` | ‚úÖ |
| 9 | –ö–æ—Ä–∑–∏–Ω–∞ | `~/.local/share/Trash` | ‚úÖ |
| 10 | –õ–æ–∫–∞–ª—å–Ω—ã–π Docker | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –æ–±—Ä–∞–∑—ã, —Ç–æ–º–∞, —Å–µ—Ç–∏, build cache | ‚úÖ |
| 11 | Docker Registry V2 | –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ —á–µ—Ä–µ–∑ HTTP API | ‚úÖ |

*–° —Ñ–ª–∞–≥–æ–º `--apply` –¥–æ—Å—Ç—É–ø–Ω–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ TUI-–º–µ–Ω—é –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –±–∞–∑–µ **whiptail** (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `apt`, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç).

## üóÇÔ∏è –ò—Å–∫–ª—é—á–µ–Ω–∏—è –∫–µ—à–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ `~/.cache` —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞–ø–∫–∏ **–Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è**:

- `JetBrains` ‚Äî –∫–µ—à IDE (IntelliJ, PyCharm, etc.)
- `Google/chrome` ‚Äî –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ Chrome
- `mozilla/firefox` ‚Äî –∫–µ—à Firefox
- `Code` ‚Äî VS Code
- `code-server` ‚Äî Code Server
- `JetBrains/RemoteDev` ‚Äî JetBrains Gateway

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –º–∞—Å—Å–∏–≤ `CACHE_EXCLUDE_DIRS` –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞:

```bash
CACHE_EXCLUDE_DIRS=(
    "JetBrains"
    "your-app"
    # –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
)
```

## üê≥ –û—á–∏—Å—Ç–∫–∞ Docker

### –°–µ–∫—Ü–∏—è 10: –õ–æ–∫–∞–ª—å–Ω—ã–π Docker

–£–¥–∞–ª—è–µ—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã Docker –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:
- –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã (–≤—Å–µ, –Ω–µ —Ç–æ–ª—å–∫–æ dangling)
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–æ–º–∞
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–µ—Ç–∏
- Build cache

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç `docker system df` –¥–æ –∏ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏.

### –°–µ–∫—Ü–∏—è 11: Docker Registry V2

–£–¥–∞–ª—è–µ—Ç –æ–±—Ä–∞–∑—ã –∏–∑ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ Docker Registry —á–µ—Ä–µ–∑ HTTP API V2.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- `curl` (`apt-get install curl`)
- URL Registry, –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–∞—Ä–æ–ª—å

**–ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è** –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å garbage collection –Ω–∞ —Ä–µ–µ—Å—Ç—Ä–µ:
```bash
docker exec <registry-container> bin/registry garbage-collect /etc/docker/registry/config.yml
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **Dry-run –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** ‚Äî –±–µ–∑ `--apply` –Ω–∏—á–µ–≥–æ –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** ‚Äî –¥–ª—è Docker –∏ –∫—Ä—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤** ‚Äî `/proc`, `/sys`, `/dev`, `/run`
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π Bash** ‚Äî `set -euo pipefail`
- **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî `/tmp/cleanup_YYYYMMDD_HHMMSS.log`
- **–ó–∞—â–∏—â—ë–Ω–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** ‚Äî –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤–∏–¥–∞ `${dir:?}` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω—è

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License. –°–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ.

---

**–í–µ—Ä—Å–∏—è**: 2.0.0  
**–ê–≤—Ç–æ—Ä**: GitHub Copilot  
**–î–∞—Ç–∞**: 2026-02-18
